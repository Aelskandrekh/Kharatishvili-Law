<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article - Kharatishvili Law</title>
    <meta name="description" content="Read the latest legal developments and news from Kharatishvili Law.">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://kharatishvili-law.com/article.html">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <a href="/" class="logo-link">Kharatishvili Law</a>
            </div>
            <button class="mobile-menu-btn" aria-label="Toggle navigation menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-menu">
                <li><a href="/" class="nav-item">Home</a></li>
                <li><a href="about.html" class="nav-item">About</a></li>
                <li><a href="resources.html" class="nav-item">Resources</a></li>
                <li><a href="contact.html" class="nav-item contact-btn">Contact Us</a></li>
            </ul>
        </div>
    </nav>

    <!-- Article Content -->
    <section class="article-section">
        <div class="container">
            <div class="article-layout">
                <!-- Table of Contents Sidebar -->
                <aside class="article-toc">
                    <div class="toc-header">
                        <h4>Table of Contents</h4>
                    </div>
                    <nav class="toc-nav" id="tocNav">
                        <div class="loading">
                            <div class="spinner-small"></div>
                            <p>Loading...</p>
                        </div>
                    </nav>
                    <div class="reading-progress">
                        <div class="progress-label">Reading Progress</div>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                    </div>
                </aside>

                <!-- Main Article Content -->
                <main class="article-main">
                    <div class="article-container">
                        <div class="article-header">
                            <a href="/" class="back-link">‚Üê Back to News</a>
                            <div class="article-meta">
                                <span class="article-date" id="articleDate"></span>
                                <span class="article-category" id="articleCategory">Legal Update</span>
                            </div>
                            <h1 class="article-title" id="articleTitle">Loading...</h1>
                            
                            <!-- Social Sharing -->
                            <div class="social-sharing">
                                <span class="share-label">Share this article:</span>
                                <div class="share-buttons">
                                    <button class="share-btn facebook" onclick="shareArticle('facebook')">
                                        <span>üìò</span> Facebook
                                    </button>
                                    <button class="share-btn twitter" onclick="shareArticle('twitter')">
                                        <span>üê¶</span> Twitter
                                    </button>
                                    <button class="share-btn linkedin" onclick="shareArticle('linkedin')">
                                        <span>üíº</span> LinkedIn
                                    </button>
                                    <button class="share-btn copy" onclick="copyArticleLink()">
                                        <span>üîó</span> Copy Link
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="article-content" id="articleContent">
                            <div class="loading">
                                <div class="spinner"></div>
                                <p>Loading article...</p>
                            </div>
                        </div>
                        
                        <div class="article-footer">
                            <div class="article-author">
                                <div class="author-info">
                                    <img src="images/aleksandre-attorney-photo.png" alt="Aleksandre Kharatishvili" class="author-photo">
                                    <div>
                                        <h4>Aleksandre Kharatishvili</h4>
                                        <p>Attorney licensed in New York & Georgia</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- Contact CTA -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2>Need Legal Consultation?</h2>
                <p>Contact us to discuss how these legal developments may affect your specific situation.</p>
                <div class="cta-actions">
                    <a href="contact.html" class="btn btn-primary">Schedule Consultation</a>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h4>Kharatishvili Law</h4>
                    <p>Premier legal services in Tbilisi, Georgia</p>
                </div>
                <div class="footer-contact">
                    <p>Tbilisi, Georgia</p>
                    <p>+995 577 335 540</p>
                    <p>aleksandrekharatishvili@gmail.com</p>
                </div>
            </div>
            <div class="footer-trust">
                <div class="trust-symbols">
                    <div class="trust-item">
                        <span class="trust-icon">üîí</span>
                        <span class="trust-text">SSL Secured</span>
                    </div>
                    <div class="trust-item">
                        <span class="trust-icon">‚öñÔ∏è</span>
                        <span class="trust-text">Licensed Attorney</span>
                    </div>
                    <div class="trust-item">
                        <span class="trust-icon">üåü</span>
                        <span class="trust-text">Fulbright Scholar</span>
                    </div>
                    <div class="trust-item">
                        <span class="trust-icon">üèõÔ∏è</span>
                        <span class="trust-text">NY & GA Qualified</span>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Kharatishvili Law. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        let currentArticle = null;
        
        // Load article content
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const articleId = urlParams.get('id');
            
            if (!articleId) {
                window.location.href = '/';
                return;
            }
            
            loadArticle(articleId);
        });
        
        function loadArticle(articleId) {
            const articles = JSON.parse(localStorage.getItem('kharatishviliLawArticles') || '[]');
            const article = articles.find(a => a.id === articleId && a.status === 'published');
            
            if (!article) {
                document.getElementById('articleContent').innerHTML = `
                    <div class="error-state">
                        <h3>Article Not Found</h3>
                        <p>The article you're looking for doesn't exist or has been removed.</p>
                        <a href="/" class="btn btn-primary">Return Home</a>
                    </div>
                `;
                return;
            }
            
            currentArticle = article;
            
            // Update page title and meta
            document.title = `${article.title} - Kharatishvili Law`;
            
            // Format date
            const articleDate = new Date(article.date);
            const formattedDate = articleDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            
            // Get practice area info
            const practiceInfo = getPracticeAreaInfo(article.practiceArea);
            
            // Update content
            document.getElementById('articleDate').textContent = formattedDate;
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleContent').innerHTML = article.content;
            
            // Update practice area category
            const categoryElement = document.getElementById('articleCategory');
            if (article.practiceArea && categoryElement) {
                categoryElement.textContent = practiceInfo.label;
                categoryElement.style.backgroundColor = practiceInfo.bgColor;
                categoryElement.style.color = practiceInfo.color;
                categoryElement.style.border = `1px solid ${practiceInfo.color}`;
                categoryElement.style.padding = '0.25rem 0.75rem';
                categoryElement.style.borderRadius = '12px';
                categoryElement.style.fontSize = '0.75rem';
                categoryElement.style.fontWeight = '500';
                categoryElement.style.textTransform = 'uppercase';
                categoryElement.style.letterSpacing = '0.5px';
            }
            
            // Generate table of contents
            setTimeout(() => {
                generateTableOfContents();
                setupReadingProgress();
            }, 100);
        }

        function getPracticeAreaInfo(practiceArea) {
            const practiceAreas = {
                'immigration': {
                    label: 'Immigration Law',
                    color: '#3498db',
                    bgColor: 'rgba(52, 152, 219, 0.1)'
                },
                'corporate': {
                    label: 'Corporate Law',
                    color: '#27ae60',
                    bgColor: 'rgba(39, 174, 96, 0.1)'
                },
                'real-estate': {
                    label: 'Real Estate Law',
                    color: '#f1c40f',
                    bgColor: 'rgba(241, 196, 15, 0.1)'
                },
                'litigation': {
                    label: 'Litigation & Arbitration',
                    color: '#e74c3c',
                    bgColor: 'rgba(231, 76, 60, 0.1)'
                },
                'tax-regulatory': {
                    label: 'Tax & Regulatory',
                    color: '#7f8c8d',
                    bgColor: 'rgba(127, 140, 141, 0.1)'
                },
                'intellectual-property': {
                    label: 'Intellectual Property',
                    color: '#9b59b6',
                    bgColor: 'rgba(155, 89, 182, 0.1)'
                }
            };
            
            return practiceAreas[practiceArea] || {
                label: 'Legal Update',
                color: '#7f8c8d',
                bgColor: 'rgba(127, 140, 141, 0.1)'
            };
        }
        
        function generateTableOfContents() {
            const content = document.getElementById('articleContent');
            const headings = content.querySelectorAll('h1, h2, h3, h4, h5, h6');
            const tocNav = document.getElementById('tocNav');
            
            if (headings.length === 0) {
                tocNav.innerHTML = '<p class="no-toc">No sections found</p>';
                return;
            }
            
            let tocHTML = '<ol class="toc-list">';
            
            headings.forEach((heading, index) => {
                const id = `section-${index}`;
                heading.id = id;
                
                const level = parseInt(heading.tagName.charAt(1));
                const text = heading.textContent;
                
                tocHTML += `
                    <li class="toc-item toc-level-${level}">
                        <a href="#${id}" class="toc-link" data-target="${id}">
                            ${text}
                        </a>
                    </li>
                `;
            });
            
            tocHTML += '</ol>';
            tocNav.innerHTML = tocHTML;
            
            // Add click handlers for smooth scrolling
            tocNav.querySelectorAll('.toc-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('data-target');
                    const targetElement = document.getElementById(targetId);
                    
                    if (targetElement) {
                        // Calculate offset for fixed navbar
                        const navbarHeight = document.querySelector('.navbar').offsetHeight;
                        const elementPosition = targetElement.offsetTop;
                        const offsetPosition = elementPosition - navbarHeight - 30; // 30px extra spacing
                        
                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });
                        
                        // Update active state
                        tocNav.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                        this.classList.add('active');
                    }
                });
            });
        }
        
        function setupReadingProgress() {
            const progressFill = document.getElementById('progressFill');
            const articleContent = document.getElementById('articleContent');
            
            function updateProgress() {
                const rect = articleContent.getBoundingClientRect();
                const windowHeight = window.innerHeight;
                const documentHeight = rect.height;
                const scrollTop = window.pageYOffset;
                const articleTop = rect.top + scrollTop;
                
                const progress = Math.max(0, Math.min(100, 
                    ((scrollTop - articleTop + windowHeight) / documentHeight) * 100
                ));
                
                progressFill.style.width = `${progress}%`;
                
                // Update active TOC item based on scroll position
                updateActiveTocItem();
            }
            
            function updateActiveTocItem() {
                const headings = document.querySelectorAll('#articleContent h1, #articleContent h2, #articleContent h3, #articleContent h4, #articleContent h5, #articleContent h6');
                const tocLinks = document.querySelectorAll('.toc-link');
                const navbarHeight = document.querySelector('.navbar').offsetHeight;
                
                let currentHeading = null;
                
                headings.forEach(heading => {
                    const rect = heading.getBoundingClientRect();
                    // Use navbar height + buffer for accurate detection
                    if (rect.top <= navbarHeight + 50) {
                        currentHeading = heading;
                    }
                });
                
                tocLinks.forEach(link => link.classList.remove('active'));
                
                if (currentHeading) {
                    const activeLink = document.querySelector(`[data-target="${currentHeading.id}"]`);
                    if (activeLink) {
                        activeLink.classList.add('active');
                    }
                }
            }
            
            window.addEventListener('scroll', updateProgress);
            updateProgress(); // Initial call
        }
        
        // Social Sharing Functions
        function shareArticle(platform) {
            if (!currentArticle) return;
            
            const url = window.location.href;
            const title = currentArticle.title;
            const summary = currentArticle.summary;
            
            let shareUrl = '';
            
            switch (platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(title)}&url=${encodeURIComponent(url)}`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(url)}`;
                    break;
            }
            
            if (shareUrl) {
                window.open(shareUrl, '_blank', 'width=600,height=400,scrollbars=yes,resizable=yes');
            }
        }
        
        function copyArticleLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                const button = document.querySelector('.share-btn.copy');
                const originalText = button.innerHTML;
                button.innerHTML = '<span>‚úÖ</span> Copied!';
                button.style.background = '#28a745';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.background = '';
                }, 2000);
            }).catch(() => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = window.location.href;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                alert('Link copied to clipboard!');
            });
        }
    </script>
    <script src="script.js"></script>
</body>
</html>